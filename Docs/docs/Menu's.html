<div class="wikidoc">
<p>Menus and Toolbars</p>
<p>&nbsp;Menu's and toolbars can be merged together from xaml in the main applications window (or other window)&nbsp;and&nbsp;from a module (or same app if you desire).&nbsp; (This functionality was taken from a great open source example on CodeProject, and
 slightly modified).</p>
<p>&nbsp;</p>
<p>Example of Menu resources in a Shell.xaml file:</p>
<p>&nbsp;</p>
<div style="color:black; background-color:white">
<pre><span style="color:blue">&lt;</span><span style="color:#a31515">Window.Resources</span><span style="color:blue">&gt;</span>

        <span style="color:blue">&lt;</span><span style="color:#a31515">ResourceDictionary</span><span style="color:blue">&gt;</span>
            <span style="color:blue">&lt;</span><span style="color:#a31515">ResourceDictionary.MergedDictionaries</span><span style="color:blue">&gt;</span>
                <span style="color:blue">&lt;</span><span style="color:#a31515">ResourceDictionary</span><span style="color:blue">&gt;</span>


                    <span style="color:blue">&lt;</span><span style="color:#a31515">MenuItem</span> <span style="color:red">Header</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">File</span><span style="color:black">&quot;</span>  <span style="color:red">x:Key</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">fileMenu</span><span style="color:black">&quot;</span> <span style="color:red">mm:MergeMenus.Id</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">mergefileMenu</span><span style="color:black">&quot;</span> <span style="color:red">mm:MergeMenus.Priority</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">10</span><span style="color:black">&quot;</span> <span style="color:red">mm:MergeMenus.HostId</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">MainMenu</span><span style="color:black">&quot;</span><span style="color:blue">&gt;</span>
                        <span style="color:blue">&lt;</span><span style="color:#a31515">MenuItem</span> <span style="color:red">Header</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Open</span><span style="color:black">&quot;</span> <span style="color:red">Command</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">ApplicationCommands.Open</span><span style="color:black">&quot;</span> <span style="color:red">mm:MergeMenus.Priority</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">10</span><span style="color:black">&quot;</span><span style="color:blue">/&gt;</span>
                        <span style="color:blue">&lt;</span><span style="color:#a31515">MenuItem</span> <span style="color:red">Header</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Save</span><span style="color:black">&quot;</span> <span style="color:red">Command</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">ApplicationCommands.Save</span><span style="color:black">&quot;</span> <span style="color:red">mm:MergeMenus.Priority</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">20</span><span style="color:black">&quot;</span><span style="color:blue">/&gt;</span>
                        <span style="color:blue">&lt;</span><span style="color:#a31515">MenuItem</span> <span style="color:red">Header</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Save As...</span><span style="color:black">&quot;</span> <span style="color:red">Command</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">ApplicationCommands.SaveAs</span><span style="color:black">&quot;</span> <span style="color:red">mm:MergeMenus.Priority</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">30</span><span style="color:black">&quot;</span><span style="color:blue">/&gt;</span>
                        <span style="color:blue">&lt;</span><span style="color:#a31515">MenuItem</span> <span style="color:red">Header</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Exit</span><span style="color:black">&quot;</span> <span style="color:red">Command</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">w:AppCanCommands.Exit</span><span style="color:black">&quot;</span> <span style="color:red">mm:MergeMenus.Priority</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">100000</span><span style="color:black">&quot;</span><span style="color:blue">/&gt;</span>
                    <span style="color:blue">&lt;/</span><span style="color:#a31515">MenuItem</span><span style="color:blue">&gt;</span>
                    <span style="color:blue">&lt;</span><span style="color:#a31515">MenuItem</span> <span style="color:red">Header</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Edit</span><span style="color:black">&quot;</span>  <span style="color:red">x:Key</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">editMenu</span><span style="color:black">&quot;</span> <span style="color:red">mm:MergeMenus.Id</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">mergeeditMenu</span><span style="color:black">&quot;</span> <span style="color:red">mm:MergeMenus.HostId</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">MainMenu</span><span style="color:black">&quot;</span> <span style="color:red">mm:MergeMenus.Priority</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">20</span><span style="color:black">&quot;</span><span style="color:blue">&gt;</span>

                        <span style="color:blue">&lt;</span><span style="color:#a31515">MenuItem</span> <span style="color:red">Header</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Copy</span><span style="color:black">&quot;</span> <span style="color:red">Command</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">ApplicationCommands.Copy</span><span style="color:black">&quot;</span> <span style="color:red">mm:MergeMenus.Priority</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">10</span><span style="color:black">&quot;</span><span style="color:blue">/&gt;</span>
                        <span style="color:blue">&lt;</span><span style="color:#a31515">MenuItem</span> <span style="color:red">Header</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Paste</span><span style="color:black">&quot;</span> <span style="color:red">Command</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">ApplicationCommands.Paste</span><span style="color:black">&quot;</span> <span style="color:red">mm:MergeMenus.Priority</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">20</span><span style="color:black">&quot;</span><span style="color:blue">/&gt;</span>

                    <span style="color:blue">&lt;/</span><span style="color:#a31515">MenuItem</span><span style="color:blue">&gt;</span>



                <span style="color:blue">&lt;/</span><span style="color:#a31515">ResourceDictionary</span><span style="color:blue">&gt;</span>
            <span style="color:blue">&lt;/</span><span style="color:#a31515">ResourceDictionary.MergedDictionaries</span><span style="color:blue">&gt;</span>
        <span style="color:blue">&lt;/</span><span style="color:#a31515">ResourceDictionary</span><span style="color:blue">&gt;</span>
    <span style="color:blue">&lt;/</span><span style="color:#a31515">Window.Resources</span><span style="color:blue">&gt;</span>
</pre>
<pre>Example of a menu that will be merged from a module's view to the shell's menu:</pre>
<pre style="color:black; background-color:white"><pre><span style="color:blue">&lt;</span><span style="color:#a31515">UserControl</span> <span style="color:red">x:Class</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">HelloWorldModule.Views.MenuView</span><span style="color:black">&quot;</span>
             <span style="color:red">xmlns</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">http://schemas.microsoft.com/winfx/2006/xaml/presentation</span><span style="color:black">&quot;</span>
             <span style="color:red">xmlns:x</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">http://schemas.microsoft.com/winfx/2006/xaml</span><span style="color:black">&quot;</span>
             <span style="color:red">xmlns:mc</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">http://schemas.openxmlformats.org/markup-compatibility/2006</span><span style="color:black">&quot;</span> 
             <span style="color:red">xmlns:d</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">http://schemas.microsoft.com/expression/blend/2008</span><span style="color:black">&quot;</span> 
             <span style="color:red">mc:Ignorable</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">d</span><span style="color:black">&quot;</span> 
             <span style="color:red">xmlns:w</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">clr-namespace:AppCan.wpf.Application;assembly=AppCan.wpf</span><span style="color:black">&quot;</span>
             <span style="color:red">xmlns:mm</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">clr-namespace:AppCan.wpf.Menus;assembly=AppCan.wpf</span><span style="color:black">&quot;</span>
             <span style="color:red">d:DesignHeight</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">300</span><span style="color:black">&quot;</span> <span style="color:red">d:DesignWidth</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">300</span><span style="color:black">&quot;</span><span style="color:blue">&gt;</span>
    
    
    
    
    <span style="color:blue">&lt;</span><span style="color:#a31515">Grid</span> <span style="color:red">Name</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">grid_main</span><span style="color:black">&quot;</span><span style="color:blue">&gt;</span>
        <span style="color:blue">&lt;</span><span style="color:#a31515">Menu</span> <span style="color:red">DockPanel.Dock</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Top</span><span style="color:black">&quot;</span> <span style="color:red">x:Name</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">mainMenu</span><span style="color:black">&quot;</span> <span style="color:red">mm:MergeMenus.Id</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">MainMenu</span><span style="color:black">&quot;</span><span style="color:blue">&gt;</span>

            <span style="color:blue">&lt;</span><span style="color:#a31515">MenuItem</span> <span style="color:red">Header</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">_Help</span><span style="color:black">&quot;</span> <span style="color:red">x:Name</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">HelpMenuItem</span><span style="color:black">&quot;</span> <span style="color:red">mm:MergeMenus.Id</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">HelpMenu</span><span style="color:black">&quot;</span> <span style="color:red">mm:MergeMenus.Priority</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">100000</span><span style="color:black">&quot;</span><span style="color:blue">/&gt;</span>
        <span style="color:blue">&lt;/</span><span style="color:#a31515">Menu</span><span style="color:blue">&gt;</span>
    <span style="color:blue">&lt;/</span><span style="color:#a31515">Grid</span><span style="color:blue">&gt;</span>
<span style="color:blue">&lt;/</span><span style="color:#a31515">UserControl</span><span style="color:blue">&gt;</span>

</pre>
<pre><pre><span style="color:red"><span style="color:#000000">&nbsp;</span></span></pre>
</pre>
<pre><span style="color:red"><span style="color:#000000"><span style="color:black"><span style="color:#000000">&nbsp;</span></span></span></span></pre>
</pre>
Note the mm:MergeMenus.Id is the name of the MergeMenu.&nbsp; In this case &quot;MainMenu&quot;.<br>
&nbsp;<br>
Notice the Shell's menu resource has in it's menu mm:MergeMenus.HostId=&quot;MainMenu&quot; which indicates<br>
to merge the current menu into the host menu.&nbsp; In the case of the Shell's resources that is the &quot;MainMenu&quot;.<br>
So the Module's menu is actually the main menu that will be merged into. (Probably should do this in the reverse way,&nbsp; but this is just an example.&nbsp;</div>
<div style="color:black; background-color:white">You will also see each menu item has a priority on it (i.e mm:MergeMenus.Priority=&quot;30&quot;)&nbsp;.&nbsp;&nbsp;These should be from lower numbers to higher by default in your xaml or sorting by value won't work properly.&nbsp;
 Lower numbers get inserted before higher numbers.</div>
<div style="color:black; background-color:white">You can also do this from code by manually setting the dependency properties on Menu's for the MergeMenu ID, Host ID and Priority.<br>
&nbsp;<br>
You can find this example in the SimpleApp sample for more details.&nbsp; Also the API docs in the docs directory have some additional details.</div>
<div style="color:black; background-color:white">This functionality came from a great code project post here.&nbsp; It's been slightly modified in AppCan.</div>
<div style="color:black; background-color:white"><a href="http://www.codeproject.com/Articles/112895/Automatic-Merging-of-Menus-and-Toolbars-in-WPF">http://www.codeproject.com/Articles/112895/Automatic-Merging-of-Menus-and-Toolbars-in-WPF</a></div>
</div><div class="ClearBoth"></div>